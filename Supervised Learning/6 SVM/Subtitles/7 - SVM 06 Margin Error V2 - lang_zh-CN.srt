1
00:00:00,000 --> 00:00:02,384
那现在 我们来建一个边际误差

2
00:00:02,384 --> 00:00:04,519
这是同样的两组数据

3
00:00:04,519 --> 00:00:06,794
这是分界线

4
00:00:06,794 --> 00:00:09,240
这是间隔

5
00:00:09,240 --> 00:00:13,463
现在 左边模型和右边模型的不同之处在于

6
00:00:13,462 --> 00:00:15,869
左边模型的间隔较大

7
00:00:15,869 --> 00:00:19,035
而右图模型的间隔较小

8
00:00:19,035 --> 00:00:22,304
让我们回想一下 间隔指是两条线之间的距离

9
00:00:22,304 --> 00:00:24,089
我们想要把间隔转化为一个误差

10
00:00:24,089 --> 00:00:26,711
我们就可以使用梯度下降法将误差最小化

11
00:00:26,711 --> 00:00:31,155
我们将编写一个函数 使之在间隔大的情况下误差最小

12
00:00:31,155 --> 00:00:34,109
以及在间隔小的情况下误差最大

13
00:00:34,109 --> 00:00:36,719
这是因为我们想要惩罚较小的间隔

14
00:00:36,719 --> 00:00:40,500
以获得一个拥有尽可能大间隔的模型

15
00:00:40,500 --> 00:00:42,869
你将会发现这很简单

16
00:00:42,869 --> 00:00:46,304
这里我们有一条线及另外两条边界线

17
00:00:46,304 --> 00:00:49,769
间隔就是外面这两条线之间的距离

18
00:00:49,770 --> 00:00:53,232
我们的方程式是 wx+b=0

19
00:00:53,231 --> 00:00:57,314
两条虚线的方程是 wx+b=1

20
00:00:57,314 --> 00:00:59,669
和 wx+b=-1

21
00:00:59,670 --> 00:01:03,120
这就是我们选择它们的方式 同样也是选择间隔的方式 

22
00:01:03,119 --> 00:01:06,929
然后像讲师注释里一样 用 2 除以向量 W 的模

23
00:01:06,930 --> 00:01:10,395
我们要记住 

24
00:01:10,394 --> 00:01:14,159
向量 w 的模是向量分量 也就是 w1 和 w2

25
00:01:14,159 --> 00:01:16,274
平方和的平方根

26
00:01:16,275 --> 00:01:18,510
接下来 让我们用这个误差

27
00:01:18,510 --> 00:01:20,579
找到较小间隔的最大值

28
00:01:20,579 --> 00:01:22,739
以及较大间隔的最小值

29
00:01:22,739 --> 00:01:25,628
很简单 既然向量 w 的模是分母

30
00:01:25,629 --> 00:01:27,165
那么我们取向量 w 的模

31
00:01:27,165 --> 00:01:30,465
它就应该与间隔呈反比 是不是很棒

32
00:01:30,465 --> 00:01:33,090
事实上  鉴于我不喜欢平方根

33
00:01:33,090 --> 00:01:35,520
那我们就用向量 w 模的平方

34
00:01:35,519 --> 00:01:40,859
即向量分量 w 平方的和 在这种情况下

35
00:01:40,859 --> 00:01:43,394
就是 w1 的平方加 w2 的平方

36
00:01:43,394 --> 00:01:47,069
如我们之前所看到的 w 出现在分母上

37
00:01:47,069 --> 00:01:52,109
因此 较大间隔代表较小误差 而较小间隔则代表较大误差

38
00:01:52,109 --> 00:01:53,834
这恰好就是我们想要的结果

39
00:01:53,834 --> 00:01:56,234
我们用一个例子来解释

40
00:01:56,234 --> 00:02:00,075
比如 w 是（3,4）我们的偏差是 1

41
00:02:00,075 --> 00:02:05,129
那我们的方程 w1x1+w2x2+b=0

42
00:02:05,129 --> 00:02:10,454
就变成了 3x1+4x2+1=0

43
00:02:10,455 --> 00:02:12,120
这就是我们的主线

44
00:02:12,120 --> 00:02:14,299
它的两侧分别有一根条虚线

45
00:02:14,299 --> 00:02:18,705
一条线的方程是 3x1+4x2+1=1

46
00:02:18,705 --> 00:02:22,620
另外一条是 3x1 + 4x2 + 1 = -1

47
00:02:22,620 --> 00:02:25,500
那么现在 误差是 w 模的平方

48
00:02:25,500 --> 00:02:27,539
即 3 的平方加 4 的平方

49
00:02:27,539 --> 00:02:29,804
得出的误差是 25
 
50
00:02:29,805 --> 00:02:32,568
而间隔就是 w 的模除以 2

50
00:02:32,568 --> 00:02:35,820
而 w 的模是 25 的平方根 即 5

51
00:02:35,819 --> 00:02:39,269
那么 间隔就是五分之二 误差就是 25

52
00:02:39,270 --> 00:02:43,469
记住这两个数字 误差 25 间隔 2.5

53
00:02:43,469 --> 00:02:47,969
现在 让我们来看一个相似的例子 
 
55
00:02:47,969 --> 00:02:50,189
数字变成了w=（6,8）而偏差是 2

54
00:02:50,189 --> 00:02:56,969
因此我们的等式就变成了 6x1+8x2+2=0

55
00:02:56,969 --> 00:03:01,425
你会注意到 该等式就是之前等式乘了 2

56
00:03:01,425 --> 00:03:06,450
因此 我们得出的分界线是一样的 因为当 3x1+4x2+1 等于 0

57
00:03:06,449 --> 00:03:10,079
6x1+8x2+2 同样也等于 0

58
00:03:10,080 --> 00:03:14,715
但现在 我们的两条虚线之间的距离更小了 因为现在数值变了

59
00:03:14,715 --> 00:03:18,780
之前 我们的等式是 3x1+4x2+1 = 1

60
00:03:18,780 --> 00:03:21,765
现在是之前的两倍等于 1

61
00:03:21,764 --> 00:03:25,049
意味着 3x1+4x2+1 是 0.5

62
00:03:25,050 --> 00:03:26,730
也意味着这条线靠的更近了

63
00:03:26,729 --> 00:03:28,844
距离实际上是之前的一半

64
00:03:28,844 --> 00:03:31,514
下面这条线同样如此

65
00:03:31,514 --> 00:03:34,529
我们的误差是该向量模的平方

66
00:03:34,530 --> 00:03:37,469
即 6 的平方加 8 的平方 等于 100

67
00:03:37,469 --> 00:03:42,150
因此我们的距离就是 2 除以向量 w 模的一半 即 2/10

68
00:03:42,150 --> 00:03:43,995
等于 1/5

69
00:03:43,995 --> 00:03:47,284
这比之前的间隔 2/5 小

70
00:03:47,284 --> 00:03:48,939
这很有趣

71
00:03:48,939 --> 00:03:50,949
两个模型呈现出同样的分界线

72
00:03:50,949 --> 00:03:53,724
但其中一个的间隔比另一个更大

73
00:03:53,724 --> 00:03:55,750
最后 我们来总结一下这个例子

74
00:03:55,750 --> 00:03:57,219
这边的间隔更大 为 2/5

75
00:03:57,219 --> 00:04:01,150
但误差更小 为 25

76
00:04:01,150 --> 00:04:03,355
而这边间隔较小 为 2/10

77
00:04:03,354 --> 00:04:06,819
即 1/5 但误差较大 为 100

78
00:04:06,819 --> 00:04:08,919
这就是边际误差

79
00:04:08,919 --> 00:04:11,334
即向量 w 模的平方

80
00:04:11,335 --> 00:04:12,594
思考一下你会发现

81
00:04:12,594 --> 00:04:15,400
这和 L2 正则化中的正则化项一样

82
00:04:15,400 --> 00:04:20,600
很奇妙 不是吗？

