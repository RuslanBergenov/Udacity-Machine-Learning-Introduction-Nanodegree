1
00:00:02,440 --> 00:00:07,140
我们通过讲解另一个例子 进一步了解交叉熵

2
00:00:07,140 --> 00:00:08,935
假如我们有三个门

3
00:00:08,935 --> 00:00:11,330
注意这不是蒙特霍尔问题

4
00:00:11,330 --> 00:00:13,775
我们有绿色 红色

5
00:00:13,775 --> 00:00:18,720
和蓝色的门 每个门后面可能有礼物 也可能没有

6
00:00:18,720 --> 00:00:23,150
这些门后面有礼物的概率分别是 第一个门是 0.8

7
00:00:23,150 --> 00:00:24,935
第二个门是 0.7

8
00:00:24,935 --> 00:00:26,900
第三个门是 0.1

9
00:00:26,900 --> 00:00:29,805
那么绿门后面

10
00:00:29,805 --> 00:00:33,155
有礼物的概率是 80%

11
00:00:33,155 --> 00:00:36,780
没有礼物的概率是 20%

12
00:00:36,780 --> 00:00:39,610
我们把这些信息放入表格

13
00:00:39,610 --> 00:00:42,970
其中有礼物的概率放在上面一行

14
00:00:42,970 --> 00:00:46,630
没有礼物的概率放在下面一行

15
00:00:46,630 --> 00:00:49,180
假设我们想赌一赌结果

16
00:00:49,180 --> 00:00:53,375
想要计算这里最可能出现的场景

17
00:00:53,375 --> 00:00:56,880
为此我们假设它们是独立事件

18
00:00:56,880 --> 00:00:59,870
在这个例子中 最可能出现的场景是

19
00:00:59,870 --> 00:01:03,440
通过挑选每一列中的最大概率来获得

20
00:01:03,440 --> 00:01:06,875
所以第一个门有礼物的可能性比没有礼物的可能性更大

21
00:01:06,875 --> 00:01:09,230
所以我们说第一个门后面有礼物

22
00:01:09,230 --> 00:01:12,680
对于第二个门 也是很有可能有礼物

23
00:01:12,680 --> 00:01:14,995
所以我们说第二个门后面有礼物

24
00:01:14,995 --> 00:01:18,060
对于第三个门 很有可能没有礼物

25
00:01:18,060 --> 00:01:21,015
所以我们说第三个门后面没有礼物

26
00:01:21,015 --> 00:01:22,700
因为这些事件是独立的

27
00:01:22,700 --> 00:01:24,810
整件事的概率是

28
00:01:24,810 --> 00:01:27,995
三个概率的乘积 即 0.8

29
00:01:27,995 --> 00:01:31,096
乘以 0.7 乘以 0.9

30
00:01:31,096 --> 00:01:33,446
最后得到 0.504

31
00:01:33,446 --> 00:01:36,665
约为 50%

32
00:01:36,665 --> 00:01:39,680
我们来观察表格中所有可能的场景

33
00:01:39,680 --> 00:01:43,085
这个表格是每个门的所有场景

34
00:01:43,085 --> 00:01:46,940
由于每个门有两个结果 共有三个门

35
00:01:46,940 --> 00:01:48,815
所以有八个场景

36
00:01:48,815 --> 00:01:51,545
与之前求每个情况的概率相同 我们

37
00:01:51,545 --> 00:01:57,245
通过三个独立概率相乘 得到这些数字

38
00:01:57,245 --> 00:01:59,590
你可以发现这些数字加起来等于 1

39
00:01:59,590 --> 00:02:02,570
从上个视频中 我们了解到交叉熵中

40
00:02:02,570 --> 00:02:05,955
负对数的概率

41
00:02:05,955 --> 00:02:09,050
那么我们继续进行 计算交叉熵

42
00:02:09,050 --> 00:02:12,080
注意高概率的事件

43
00:02:12,080 --> 00:02:16,345
交叉熵低 而低概率的事件交叉熵高

44
00:02:16,345 --> 00:02:19,130
例如第二行的概率是 0.504

45
00:02:19,130 --> 00:02:24,440
得到较小的交叉熵 0.69

46
00:02:24,440 --> 00:02:28,675
倒数第二行概率仅为 0.006

47
00:02:28,675 --> 00:02:34,441
交叉熵是 5.12

48
00:02:34,441 --> 00:02:37,573
那么我们实际上可以计算交叉熵的公式

49
00:02:37,573 --> 00:02:39,215
这里是我们的三个门

50
00:02:39,215 --> 00:02:44,180
样本场景说明第一个门和第二个门后面有礼物

51
00:02:44,180 --> 00:02:46,445
第三个门后面没有礼物

52
00:02:46,445 --> 00:02:49,370
回想这些事件发生的概率

53
00:02:49,370 --> 00:02:52,189
第一个门后面有礼物的概率是 0.8

54
00:02:52,189 --> 00:02:54,665
第二个门后面有礼物的概率是 0.7

55
00:02:54,665 --> 00:02:57,915
第三个门后面没有礼物的概率是 0.9

56
00:02:57,915 --> 00:02:59,510
那么我们计算交叉熵后

57
00:02:59,510 --> 00:03:03,622
我们负对数的乘积

58
00:03:03,622 --> 00:03:08,015
即这些因子负对数的总和

59
00:03:08,015 --> 00:03:14,070
即 0.8 的负对数乘以 0.7 的负对数乘以 0.9 的负对数

60
00:03:14,070 --> 00:03:17,225
为了推导出公式 我们要有一些变量

61
00:03:17,225 --> 00:03:20,885
所以我们使用 P1 表示第一个门后面有礼物的概率

62
00:03:20,885 --> 00:03:24,110
P2 表示第二个门后面有礼物的概率

63
00:03:24,110 --> 00:03:27,940
P3 表示第三个门后面有礼物的概率

64
00:03:27,940 --> 00:03:30,580
所以 0.8 是 P1

65
00:03:30,580 --> 00:03:32,580
0.7 是 P2

66
00:03:32,580 --> 00:03:35,370
0.9 是 1-P3

67
00:03:35,370 --> 00:03:36,990
那么没有礼物的概率等于

68
00:03:36,990 --> 00:03:41,460
1 减去有礼物的概率

69
00:03:41,460 --> 00:03:43,785
我们使用另一个变量 叫做 Yi

70
00:03:43,785 --> 00:03:46,980
即如果第 i 个门后面有礼物 Yi 为 1

71
00:03:46,980 --> 00:03:49,750
如果没有礼物 Yi 为 0

72
00:03:49,750 --> 00:03:53,470
所以从技术上讲 Yi 表示第 i 个门后面有一些礼物

73
00:03:53,470 --> 00:03:55,442
那么在这个例子中 Y1 等于 1

74
00:03:55,442 --> 00:04:00,210
Y2 等于 1 Y3 等于 0

75
00:04:00,210 --> 00:04:02,550
所以我们可以把这些加起来 推导出

76
00:04:02,550 --> 00:04:05,355
交叉熵的公式 也就是这个总和

77
00:04:05,355 --> 00:04:08,305
我们来观察一下这个总和内部的公式

78
00:04:08,305 --> 00:04:12,155
注意如果第 i 个门后面有礼物

79
00:04:12,155 --> 00:04:14,300
那么 Yi 等于 1

80
00:04:14,300 --> 00:04:17,180
所以第一项是 ln(Pi)

81
00:04:17,180 --> 00:04:19,795
第二项是 0

82
00:04:19,795 --> 00:04:24,285
类似地 如果第 i 个门后面没有礼物

83
00:04:24,285 --> 00:04:26,355
那么 Yi 等于 0

84
00:04:26,355 --> 00:04:28,355
那么第一项是 0

85
00:04:28,355 --> 00:04:32,655
这一项是 ln(1-Pi)

86
00:04:32,655 --> 00:04:35,785
因此这个公式包含了

87
00:04:35,785 --> 00:04:39,935
负对数的总和 准确说是交叉熵的总和

88
00:04:39,935 --> 00:04:45,640
所以交叉熵实际上说明了两个向量相似或不同时

89
00:04:45,640 --> 00:04:52,170
例如 如果你计算一对 (1,1,0)

90
00:04:52,170 --> 00:04:53,485
和 (0.8,0.7,0.1) 的交叉熵 我们得到 0.69

91
00:04:53,485 --> 00:05:00,500
这个数字很低 是因为(1,1,0) 类似于 (0.8,0.7,0.1)

92
00:05:00,500 --> 00:05:05,510
根据第二组数字的概率可以看出

93
00:05:05,510 --> 00:05:08,270
第一组数字相关的礼物顺序

94
00:05:08,270 --> 00:05:11,715
很有可能发生

95
00:05:11,715 --> 00:05:17,107
不过另一方面 如果我们计算 (0,0,1) 和

96
00:05:17,107 --> 00:05:19,559
(0.8,0.7,0.1) 的交叉熵

97
00:05:19,559 --> 00:05:23,210
得到 5.12 这个结果很高

98
00:05:23,210 --> 00:05:27,380
根据第二组数字的概率可以看出

99
00:05:27,380 --> 00:05:32,030
第一组数字相关的礼物顺序发生可能性更小

